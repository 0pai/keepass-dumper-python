# KeePass メモリダンプ解析ツール

## 概要
このツールは、**KeePass 2.x** の **SecureTextBoxEx** に入力されたマスターパスワードを、メモリダンプから復元するための Python スクリプトです。

## 使い方
### 1. スクリプトの実行
```sh
python3 keepass-dumper.py メモリダンプファイル [パスワードリスト出力ファイル]
```
- `メモリダンプファイル`: メモリダンプのパス
- `パスワードリスト出力ファイル` (省略可能): パスワードの可能性をリスト化して保存

### 2. 出力結果
- **解析結果**: パスワード候補が表示されます。
- **未知の文字**: `●` (黒丸) で表示されます。
- **復元されたパスワード候補**: `{候補1, 候補2, ...}` のように表示。
- **パスワードリスト**: 指定した場合、可能性のあるすべてのパスワードをファイルに保存。

## 処理の流れ
1. **メモリダンプをバイナリで読み込む**
2. **`0xCF 0x25` (●) のパターンを検索し、パスワードの長さを特定**
3. **UTF-16 LE でデコードし、パスワード候補を抽出**
4. **正規表現 (`[ 4. **正規表現 (`[\x20-ÿ4. **正規表現 (`[\x20-\xFF]+`) でフィルタリング**
5. **パスワードリストの生成 (オプション)**

## 注意事項
- **このツールは教育目的のみ** で提供されています。
- **自身が所有または許可された環境でのみ使用** してください。
- **違法行為には使用しないでください**。

## 動作環境
- **Python 3.x**
- **Linux (Kali Linux 推奨)**
- **必要なモジュール**: `re`, `sys`, `os`, `collections`

## ライセンス
このツールは **オープンソース** ですが、利用時は責任を持って適切に使用してください。

## HackTheBox Keeper Writeup
https://note.com/kplus33/n/n4bfe79f3108a
